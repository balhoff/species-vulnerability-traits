library(taxize)
habitat_breadth <- read.csv(file="data/habitat_breadth.csv")
home_range <- read.csv(file="data/home_range.csv")
names <- c(as.character(habitat_breadth[, 'Scientific.Name']), as.character(home_range[, 'Scientific.Name']))
unique_names <- unique(names)
parsed_names <- gbif_parse(scientificname=unique_names)
canonical_names <- parsed_names[, 'canonicalname']
taxonomy_info <- classification(canonical_names, db="col")
taxonomy_info_cleaned <- taxonomy_info[!is.na(taxonomy_info)]
library(plyr)
library(reshape2)
taxonomy_table <- ldply(taxonomy_info_cleaned, function(x){
  tmp <- data.frame(t(x$name))
  names(tmp) <- x$rank
  tmp
})
write.csv(taxonomy_table, "data/taxa.csv", row.names=FALSE)
